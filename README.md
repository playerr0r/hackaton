
# Проект: Интеллектуальная система для автоматической оценки качества изображений животных

## Описание проекта
Наше решение представляет собой интеллектуальную систему, разработанную с применением технологии компьютерного зрения, которая автоматически оценивает качество изображений животных. Этот проект создан для **Министерства природных ресурсов и экологии РФ** и ориентирован на обработку большого объема изображений, полученных с фотоловушек.

### Как это работает
- **Модель YOLOv5**: Мы используем предобученную модель YOLOv5 для выделения животных на изображениях, определяя их местоположение и создавая bounding box вокруг каждого обнаруженного объекта.
- **Трансформер для оценки качества**: После выделения животного его изображение передается в трансформер, который анализирует соответствие изображения критериям качества.
- **Аугментация данных**: Чтобы улучшить точность модели, мы расширили исходный набор данных, добавив аугментации с разными уровнями искажений (сильные и слабые). Это позволяет модели адаптироваться к разнообразным условиям съёмки и более эффективно распознавать животных.
- **Веб-платформа**: Простая веб-платформа, реализованная на FastAPI, позволяет пользователям загружать изображения и классифицировать их с минимальными усилиями.

### Применение
Эта система помогает экологам, фотографам и исследователям быстро отсеивать низкокачественные изображения, что позволяет существенно экономить время и ресурсы на сбор и обработку данных.

## Стек технологий
Проект построен с использованием следующих технологий:

- **Python** — основной язык разработки.
- **PyTorch** — для работы с моделью и трансформером.
- **YOLOv5** — предобученная модель для детекции объектов.
- **OpenCV** — для обработки изображений и аугментации данных.
- **FastAPI** — для создания веб-интерфейса, позволяющего загружать и классифицировать изображения.

## Установка и настройка

### Требования
- Python 3.8+ (рекомендуется Python 3.9 или новее)
- Git для клонирования репозитория

### Шаги установки

1. Клонирование репозитория:
   ```bash
   git clone https://github.com/ваш-репозиторий/project.git
   cd project
   ```

2. Создание виртуального окружения:
   Для изоляции зависимостей создайте виртуальное окружение:
   ```bash
   python3 -m venv venv
   ```

3. Активация виртуального окружения:
   - На Windows:
     ```bash
     venv\Scripts\activate
     ```
   - На macOS и Linux:
     ```bash
     source venv/bin/activate
     ```

4. Установка зависимостей:
   Установите все необходимые библиотеки из файла `requirements.txt`:
   ```bash
   pip install -r requirements.txt
   ```

5. Проверка успешной установки:
   После завершения установки зависимостей убедитесь, что все необходимые пакеты установлены. Запустите следующую команду, чтобы проверить их версии:
   ```bash
   pip list
   ```

6. Загрузка модели YOLOv5:
   Если YOLOv5 не включен в репозиторий, загрузите предобученную модель из официального репозитория YOLOv5:
   ```bash
   git clone https://github.com/ultralytics/yolov5 yolov5
   cd yolov5
   pip install -r requirements.txt
   cd ..
   ```

7. Подготовка данных (при необходимости):
   Создайте папку `data/` в корневой директории и добавьте туда изображения для тестирования. Структура директории должна выглядеть следующим образом:
   ```plaintext
   project/
   ├── data/                   # Папка для хранения исходных и обработанных данных
   ├── models/                 # Папка с обученной моделью YOLOv5 и трансформером
   ├── app.py                  # Основной код веб-приложения
   ├── utils.py                # Вспомогательные функции для обработки данных
   ├── requirements.txt        # Зависимости проекта
   └── README.md               # Документация проекта
   ```

8. Запуск приложения:
   Теперь вы готовы запустить приложение. Используйте следующую команду:
   ```bash
   python app.py
   ```

9. Доступ к веб-интерфейсу:
   Перейдите на [локальный хост](http://127.0.0.1:8000), чтобы загрузить папку с изображениями для анализа. Приложение начнет обработку и классификацию изображений.

## Использование

1. **Загрузка изображений:** Используйте веб-интерфейс для загрузки изображений, которые требуется проанализировать.
2. **Анализ и классификация:** Программа обрабатывает изображения с помощью YOLOv5 для выделения животных и передаёт их трансформеру для анализа качества. Результаты будут классифицированы как:
   - `1` — изображение пригодно для анализа.
   - `0` — изображение вспомогательное, низкого качества.
3. **Экспорт результатов:** Результаты сохраняются в формате CSV с информацией о каждом изображении:
   - Наличие животного
   - Координаты bounding box
   - Класс пригодности (1 или 0)

## Архитектура проекта
- **YOLOv5**: Используется для обнаружения животных на изображениях, выделяя их bounding box.
- **Трансформер для оценки качества**: Принимает выделенные объекты и определяет, соответствует ли изображение критериям качества.
- **Веб-интерфейс на FastAPI**: Простой и удобный интерфейс для загрузки изображений и отображения результатов анализа.

### Структура файлов
```plaintext
project/
├── models/                 # Папка с обученной моделью YOLOv5 и трансформером
├── app.py                  # Основной код веб-приложения
├── utils.py                # Вспомогательные функции для обработки данных
├── requirements.txt        # Зависимости проекта
└── README.md               # Документация проекта
```

## Примечания и комментарии
Для повышения точности модели были использованы различные аугментации, такие как сильные и слабые искажения, что позволяет модели лучше адаптироваться к разнообразным условиям съёмки.

## Авторы
- **Ваше Имя**
- **Контактная информация**

## Лицензия
Этот проект распространяется под лицензией MIT. Подробности см. в файле `LICENSE`.
